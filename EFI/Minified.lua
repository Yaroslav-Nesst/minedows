local a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s="OrangeCat Loader","Change label","key_down","filesystem",0xFF6347,0x000000,0xD2691E,0x433218,0xA26A42,component.proxy,component.list,computer.pullSignal,computer.uptime,table.insert,math.max,math.min,math.huge,math.floor,0;local t,u,v=j(k("eeprom")()),j(k("gpu")()),k("internet")()u.bind(k("screen")(),true)local w,x,y,z,A,B,C,D,E=computer.shutdown,u.set,u.setBackground,u.setForeground,u.fill,t.setData,t.getData,u.getResolution()local F,G,H,I,J={{"/init.lua",function()end},{"/OS.lua",function()computer.getBootAddress,computer.setBootAddress=C,B end}},function(K,L,M,N,O)y(O)A(K,L,M,N," ")end,function(L,P,Q)local K=r(D/2-#Q/2)z(P)x(K,L,Q)end,function(Q)if s>E then s=1;y(0x000000)A(1,1,D/2,E," ")end;s=s+1;z(0xFFFFFF)x(1,s,Q)end,function(Q,R,S)return{s=Q,c=R,b=S}end;local function T(L,U)L=48;G(D/2-25,1,D,E,f)H(L,e,U)return L-25 end;local function V(U,W,X,Y)local Z={}local L=T(#Z,U)if Y then I(W)else for _ in W:gmatch("[^\r\n]+")do Z[#Z+1]=_:gsub("\t","  ")end;for a0=1,#Z do H(L,g,Z[a0])L=L+1 end end;if X then repeat X=l()until X==c or X=="touch"end end;local function a1(...)local a2,a3=load(...)if a2 then a2,a3=xpcall(a2,debug.traceback)if a2 then return end end;V(a,a3,false,true)end;local a4,a5,a6,a7=function(a8)for a0=1,#F do if a8.exists(F[a0][1])then V(a,"Booting from "..(a8.getLabel()or a8.address),false,true)if C()~=a8.address then B(a8.address)end;F[a0][2]()local a9,aa,ab,ac,a3=a8.open(F[a0][1],"rb"),""repeat ab=a8.read(a9,q)aa=aa..(ab or"")until not ab;a8.close(a9)a1(aa,"="..F[a0][1])return 1 end end end,function(ad)return J("Exit recovery",ad,1)end,function(U,ae)local af,ag=1,0;for a0=1,#ae do ag=math.max(ag,#ae[a0].s)end;while 1 do local L,K,ah=T(#ae+2,U)for a0=1,#ae do K=r(D/2-#ae[a0].s/2)if a0==af then G(r(D/2-ag/2)-2,L,ag+4,1,h)z(i)x(K,L,ae[a0].s)y(f)else z(g)x(K,L,ae[a0].s)end;L=L+1 end;ah={l()}if ah[1]==c then if ah[4]==200 and af>1 then af=af-1 elseif ah[4]==208 and af<#ae then af=af+1 elseif ah[4]==28 then if ae[af].c then ae[af].c()end;if ae[af].b then return end end end end end,function(L,ai)local Q,aj,ak,ah,al="",true;while 1 do ak=ai..Q;A(1,L,D,1," ")z(g)x(r(D/2-#ak/2),L,ak..(aj and"█"or""))ah={l(0.5)}if ah[1]==c then if ah[4]==28 then return Q elseif ah[4]==14 then Q=Q:sub(1,-2)else al=unicode.char(ah[3])if al:match("^[%w%d%p%s]+")then Q=Q..al end end;aj=true elseif ah[1]=="clipboard"then Q=Q..ah[3]elseif not ah[1]then aj=not aj end end end;V(a,"Press ALT to enter recovery!",false,true)local am,ah=m()+1;while m()<am do ah={l(am-m())}if ah[1]==c and ah[4]==56 then local an={J("Partitions",function()local ao,ap,aq=function(Q,ar)if#Q<ar then Q=Q..string.rep(" ",ar-#Q)else Q=Q:sub(1,ar)end;return Q.."  "end,{a5()}local function as()for a0=2,#ap do table.remove(ap,1)end;for at in k(d)do local a8=j(at)local au,av,aq=a8.getLabel()or"noname",a8.isReadOnly(),{J("Set as bootable",function()B(at)as()end,1)}if not av then n(aq,J(b,function()a8.setLabel(a7(T(2,b),"Enter new name: "))as()end,1))n(aq,J("Format",function()V(a,"Formatting "..at,false,true)for aw,ax in ipairs(a8.list("/"))do a8.remove(ax)end;as()end,1))end;n(aq,a5())n(ap,1,J((at==C()and"> "or"  ")..ao(au,12)..ao(a8.spaceTotal()>1048576 and"HDD"or a8.spaceTotal()>65536 and"FDD"or"SYS",3)..ao(av and"R"or"R/W",3)..ao(string.format("%.1f",a8.spaceUsed()/a8.spaceTotal()*100).."%",6)..at:sub(1,7).."…",function()a6(au.." ("..at..")",aq)end))end end;as()a6("Select partition",ap)end),J("Shutdown",function()w()end),a5()}if v then n(an,2,J("System recovery",function()local a9,aa,a2,a3=j(v).request("https://raw.githubusercontent.com/Yaroslav-Nesst/minedows/master/Installer/Main.lua"),""if a9 then V(a,"Running recovery script...",false,true)while 1 do a2,a3=a9.read(q)if a2 then aa=aa..a2 else a9.close()if a3 then V(a,a3,true,true)else a1(aa,"=string")end;break end end else V(a,"Invalid URL-adress",true,true)end end))end;a6(a,an)end end;local a8=j(C())if not(a8 and a4(a8))then for at in k(d)do a8=j(at)if a4(a8)then break else a8=nil end end;if not a8 then V(a,"No os/init.lua found.",true,true)end end;w()
